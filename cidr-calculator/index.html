<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CIDR Calculator - Emira Labs</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <header>
        <h1>CIDR Calculator</h1>
    </header>
    <main>
        <div class="tool-description">
            <a href="/" class="back-link"><i class="fas fa-arrow-left"></i> Back to Tools</a>
            <span class="badge">Network Tool</span>
            <h2>CIDR Calculator</h2>
            <p>Enter an IP address and CIDR prefix to calculate precise network details, subnet masks, and address ranges for efficient network planning.</p>
        </div>
        <form id="cidrForm" class="calculator-form">
            <div class="form-row">
                <input type="text" id="ip" placeholder="IP Address (e.g., 192.168.1.1)" class="form-input" required>
                <input type="number" id="cidr" min="0" max="32" placeholder="CIDR Prefix (e.g., 24)" class="form-input" required>
            </div>
            <button type="submit" class="form-submit">Calculate <i class="fas fa-calculator"></i></button>
        </form>
        <div id="result"></div>
    </main>
    <footer>
        <p>&copy; 2025 Emira Labs. All rights reserved.</p>
    </footer>

    <script>
        document.getElementById('cidrForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const ip = document.getElementById('ip').value;
            const cidr = parseInt(document.getElementById('cidr').value);
            const result = calculateCIDR(ip, cidr);
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = result;
            resultDiv.classList.add('show');
        });

        function calculateCIDR(ip, cidr) {
            const ipParts = ip.split('.').map(Number);
            if (ipParts.length !== 4 || ipParts.some(p => p < 0 || p > 255)) {
                return '<p>Invalid IP address.</p>';
            }
            const ipBinary = ipParts.map(p => p.toString(2).padStart(8, '0')).join('');
            const networkBinary = ipBinary.substring(0, cidr) + '0'.repeat(32 - cidr);
            const broadcastBinary = ipBinary.substring(0, cidr) + '1'.repeat(32 - cidr);

            const networkIP = binaryToIP(networkBinary);
            const broadcastIP = binaryToIP(broadcastBinary);
            const firstHost = cidr < 31 ? binaryToIP(networkBinary.substring(0, 31) + '1') : networkIP;
            const lastHost = cidr < 31 ? binaryToIP(broadcastBinary.substring(0, 31) + '0') : broadcastIP;
            const totalHosts = cidr <= 30 ? Math.pow(2, 32 - cidr) : 1;
            const usableHosts = cidr <= 30 ? totalHosts - 2 : 1;

            return `
                <p><strong>Network Address:</strong> ${networkIP}/${cidr}</p>
                <p><strong>Broadcast Address:</strong> ${broadcastIP}</p>
                <p><strong>First Host:</strong> ${firstHost}</p>
                <p><strong>Last Host:</strong> ${lastHost}</p>
                <p><strong>Total Hosts:</strong> ${totalHosts}</p>
                <p><strong>Usable Hosts:</strong> ${usableHosts}</p>
            `;
        }

        function binaryToIP(binary) {
            return [
                parseInt(binary.substring(0, 8), 2),
                parseInt(binary.substring(8, 16), 2),
                parseInt(binary.substring(16, 24), 2),
                parseInt(binary.substring(24, 32), 2)
            ].join('.');
        }
    </script>
</body>
</html>